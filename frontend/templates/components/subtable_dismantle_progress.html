<div class="overflow-auto">
  <div class="mb-2">
    <button
      onclick="captureTable('dismantle_progress')"
      class="text-sm bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded"
    >
      Capture
    </button>
  </div>
  <table
    id="dismantle_progress"
    class="min-w-full text-sm border border-black text-center align-middle whitespace-nowrap"
  >
    <thead class="text-xs">
      <tr>
        <th
          colspan="42"
          class="bg-blue-600 font-bold border border-black py-2 text-lg align-middle"
        >
          PROGRESS HARIAN COLLECT DISMANTLE
        </th>
      </tr>
      <tr>
        <th class="bg-red-300 border border-black px-2 py-1 align-middle">
          TOTAL TEKNISI
        </th>
        <th
          colspan="2"
          class="bg-cyan-200 border border-black px-2 py-1 align-middle"
        >
          DISMANTLE
        </th>
        <th
          class="bg-black text-white border border-black px-2 py-1 align-middle"
        >
          BERHASIL
        </th>
        <th
          class="bg-black text-white border border-black px-2 py-1 align-middle"
        >
          KENDALA
        </th>
        <th
          class="bg-blue-800 text-white border border-black px-2 py-1 align-middle"
        >
          SALDO
        </th>
        <th
          colspan="35"
          class="bg-neutral-800 border border-black px-1 py-1 align-middle"
        >
          PROGRES
        </th>
      </tr>
      <tr>
        <th class="bg-white border border-black px-2 py-1 align-middle">
          JUMLAH
        </th>
        <th class="bg-green-200 border border-black px-2 py-1 align-middle">
          SERVICE AREA
        </th>
        <th class="bg-green-300 border border-black px-2 py-1 align-middle">
          STO
        </th>
        <th class="bg-yellow-200 border border-black px-2 py-1 align-middle">
          {{ prev_month_label }}
        </th>
        <th class="bg-yellow-200 border border-black px-2 py-1 align-middle">
          {{ prev_month_label }}
        </th>
        <th
          class="bg-blue-800 text-white border border-black px-2 py-1 align-middle"
        >
          AWAL
        </th>
        <th class="bg-blue-800 text-white border border-black px-2 py-1 align-middle">
          PROGRES
        </th>
        {% for i in range(1, 32) %}
        <th
          class="bg-red-600 text-white border border-black px-2 py-1 w-[36px] align-middle"
        >
          {{ i }}
        </th>
        {% endfor %}
        <th
          class="border border-black px-2 py-1 w-[60px] align-middle"
          style="background-color: #ea580c !important"
        >
          BERHASIL
        </th>
        <th
          class="border border-black px-2 py-1 w-[60px] align-middle"
          style="background-color: #ea580c !important"
        >
          KENDALA
        </th>
        <th
          class="border border-black px-2 py-1 w-[60px] align-middle"
          style="background-color: #ea580c !important"
        >
          SISA SALDO
        </th>
      </tr>
    </thead>
    <tbody class="text-sm">
      {% if data_dismantle %} {% for row in data_dismantle %}
      <tr>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.teknisi or 0 }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.service_area or '-' }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.sto or '-' }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.berhasil_bulan_lalu or 0 }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.kendala_bulan_lalu or 0 }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.saldo_awal or 0 }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.progress or 0 }}
        </td>
        {% for i in range(1, 32) %} {% set val = getattr(row, 't' ~ i) %}
        <td
          class="border border-black px-1 py-1 align-middle {% if val|int > 0 %}bg-green-300{% endif %}"
        >
          {{ val or 0 }}
        </td>
        {% endfor %}
        <td
          class="border border-black px-2 py-1 align-middle"
          style="background-color: {{ row.warna_total_berhasil }}"
        >
          {{ row.berhasil or 0 }}
        </td>

        <td class="border border-black px-2 py-1 align-middle">
          {{ row.kendala or 0 }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ row.saldo_akhir or 0 }}
        </td>
      </tr>
      {% endfor %}
      <tr class="font-bold bg-blue-500">
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='teknisi') }}
        </td>
        <td colspan="2" class="border border-black bg-black text-white"></td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='berhasil_bulan_lalu') }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='kendala_bulan_lalu') }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='saldo_awal') }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='progress') }}
        </td>
        {% for i in range(1, 32) %}
        <td class="border border-black px-1 py-1 align-middle">
          {{ data_dismantle | sum(attribute='t' ~ i) }}
        </td>
        {% endfor %}
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='berhasil') }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='kendala') }}
        </td>
        <td class="border border-black px-2 py-1 align-middle">
          {{ data_dismantle | sum(attribute='saldo_akhir') }}
        </td>
      </tr>
      {% else %}
      <tr>
        <td
          colspan="42"
          class="text-center py-2 border border-black bg-gray-50"
        >
          Belum ada data.
        </td>
      </tr>
      {% endif %}
    </tbody>
  </table>
</div>
